<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="1027px" height="1411px" viewBox="-0.5 -0.5 1027 1411" content="&lt;mxfile host=&quot;embed.diagrams.net&quot; modified=&quot;2023-07-20T15:11:33.643Z&quot; agent=&quot;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/114.0.0.0 Safari/537.36&quot; etag=&quot;SylwziB1RwLZe6mvaBFC&quot; version=&quot;21.6.2&quot; type=&quot;embed&quot;&gt;&lt;diagram id=&quot;QB-tHsTPjBIoVIsD2LTZ&quot; name=&quot;Page-1&quot;&gt;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&lt;/diagram&gt;&lt;/mxfile&gt;" style="background-color: rgb(255, 255, 255);"><defs/><g><path d="M 90.9 964.88 Q 90.9 964.88 88.02 1306.76" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 80.64 1292.82 L 88.01 1307.88 L 95.64 1292.95" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"/><rect x="88" y="883" width="381" height="285" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 379px; height: 1px; padding-top: 1025px; margin-left: 90px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: left;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><br /><br /><br /><br />1. Read the data file<br /><div style=""><span style="background-color: initial;">2. Extract PTs from data and calculate frequencies</span></div>3. Check if PTs are standardized or not<br />4. Get unstandardized PTs<br />5. Try to translate unstandardized PTs through LLTs<br />6. If still untraslated, use manual integration<br />7. Combine PTs from LLTs, manual integration, and already standardized PTs<br />8. Write updated manual fix file<br />9. Update PTs in the data file<br />10. Calculate the portion of standardized PTs<br />11. Return the standardized data and standardized percentage</div></div></div></foreignObject><text x="90" y="1029" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px">1. Read the data file...</text></switch></g><rect x="8" y="8" width="163" height="79" rx="11.85" ry="11.85" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 161px; height: 1px; padding-top: 47px; margin-left: 9px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">Importing the MedDRA dictionary, including the paths where the data can be found and rename columns</div></div></div></foreignObject><text x="90" y="51" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">Importing the MedDRA dictio...</text></switch></g><rect x="177" y="10" width="680" height="235" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 678px; height: 1px; padding-top: 128px; margin-left: 179px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: left;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><div><font color="#3333ff">soc &lt;- read.csv2("External Sources/Dictionaries/MedDRA/MedAscii/soc.asc", <span style="background-color: initial;">sep = "$", header=F) %&gt;% select(1:3)</span></font></div><div><font color="#3333ff">colnames(soc) &lt;- c("soc_cod","soc","def")</font></div><div><font color="#3333ff">soc_hlgt &lt;- read.csv2("External Sources/Dictionaries/MedDRA/MedAscii/soc_hlgt.asc", <span style="background-color: initial;">sep = "$", header=F) %&gt;% select(1:2)</span></font></div><div><font color="#3333ff">colnames(soc_hlgt) &lt;- c("soc_cod","hlgt_cod")</font></div><div><font color="#3333ff">hlgt &lt;- read.csv2("External Sources/Dictionaries/MedDRA/MedAscii/hlgt.asc", <span style="background-color: initial;">sep = "$", header=F) %&gt;% select(1:2)</span></font></div><div><font color="#3333ff">colnames(hlgt) &lt;- c("hlgt_cod","hlgt")</font></div><div><font color="#3333ff">hlgt_hlt &lt;- read.csv2("External Sources/Dictionaries/MedDRA/MedAscii/hlgt_hlt.asc", <span style="background-color: initial;">sep = "$", header=F) %&gt;% select(1:2)</span></font></div><div><font color="#3333ff">colnames(hlgt_hlt) &lt;- c("hlgt_cod","hlt_cod")</font></div><div><font color="#3333ff">hlt &lt;- read.csv2("External Sources/Dictionaries/MedDRA/MedAscii/hlt.asc", <span style="background-color: initial;">sep = "$", header=F) %&gt;% select(1:2)</span></font></div><div><font color="#3333ff">colnames(hlt) &lt;- c("hlt_cod","hlt")</font></div><div><font color="#3333ff">hlt_pt &lt;- read.csv2("External Sources/Dictionaries/MedDRA/MedAscii/hlt_pt.asc", <span style="background-color: initial;">sep = "$", header=F)  %&gt;% select(1:2)</span></font></div><div><font color="#3333ff">colnames(hlt_pt) &lt;- c("hlt_cod","pt_cod")</font></div><div><font color="#3333ff">pts &lt;- read.csv2("External Sources/Dictionaries/MedDRA/MedAscii/pt.asc", <span style="background-color: initial;">sep = "$", header=F) %&gt;% select(1:2,4)</span></font></div><div><font color="#3333ff">colnames(pts) &lt;- c("pt_cod","pt","primary_soc_cod")</font></div><div><font color="#3333ff">llt &lt;- read.csv2("External Sources/Dictionaries/MedDRA/MedAscii/llt.asc", <span style="background-color: initial;">sep = "$", header=F) %&gt;% select(1:3)</span></font></div><div><font color="#3333ff">colnames(llt) &lt;- c("llt_cod","llt","pt_cod")</font></div></div></div></div></foreignObject><text x="179" y="131" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px">soc &lt;- read.csv2("External Sources/Dictionaries/MedDRA/MedAscii/soc.asc", sep = "$", header=F) %&gt;% select(1:3)...</text></switch></g><path d="M 90 351 Q 90 351 90.27 376.76" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 82.63 362.96 L 90.28 377.88 L 97.63 362.8" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"/><rect x="9.5" y="263" width="160" height="80" rx="12" ry="12" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 158px; height: 1px; padding-top: 303px; margin-left: 10px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">Merge the levels of the MedDRA dictionary in a unique file and convert all characters to lowercase</div></div></div></foreignObject><text x="90" y="307" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">Merge the levels of the Med...</text></switch></g><path d="M 89.5 87 Q 89.5 87 89.5 252.76" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 82 238.88 L 89.5 253.88 L 97 238.88" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"/><rect x="177" y="274" width="680" height="52" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 678px; height: 1px; padding-top: 300px; margin-left: 179px;"><div data-drawio-colors="color: #3333FF; " style="box-sizing: border-box; font-size: 0px; text-align: left;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(51, 51, 255); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><div><font>meddra &lt;- setDT(merge(merge(merge(merge(merge(merge(merge(</font><span style="background-color: initial;">soc, soc_hlgt,all = TRUE),hlgt, all = TRUE),hlgt_hlt,all = TRUE),</span><span style="background-color: initial;">  hlt, all = TRUE), hlt_pt, all = TRUE), pts, all = TRUE), llt,all=TRUE))</span></div><div>meddra[,(colnames(meddra)):=lapply(.SD, tolower),]<span style="background-color: initial;"><br /></span></div></div></div></div></foreignObject><text x="179" y="304" fill="#3333FF" font-family="Helvetica" font-size="12px">meddra &lt;- setDT(merge(merge(merge(merge(merge(merge(merge(soc, soc_hlgt,all = TRUE),hlgt, all = TRUE),hlgt_hlt,al...</text></switch></g><rect x="11" y="387" width="160" height="119" rx="17.85" ry="17.85" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 158px; height: 1px; padding-top: 447px; margin-left: 12px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">Convert all characters to lowercase and export two files. The first one with the MedDRA hierarchy with all the SOCs for a given PT, the second one with the hierarchy filtered for the primary soc for a given PT</div></div></div></foreignObject><text x="91" y="450" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">Convert all characters to l...</text></switch></g><rect x="179" y="404.25" width="680" height="68.5" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 678px; height: 1px; padding-top: 439px; margin-left: 181px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: left;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><div><font color="#3333ff" style="background-color: initial;">write.csv2(distinct(meddra[,.(def,soc, hlgt,hlt,pt,llt)]),</font><span style="background-color: initial; color: rgb(51, 51, 255);"> "External Sources/Dictionaries/MedDRA/meddra.csv")</span><br /></div><div><font color="#3333ff">write.csv2(distinct(meddra[soc_cod==primary_soc_cod][,.(def,soc, hlgt,hlt,pt)]),</font><span style="color: rgb(51, 51, 255); background-color: initial;"> "ExternalSources/Dictionaries/MedDRA/meddra_primary.csv")</span></div></div></div></div></foreignObject><text x="181" y="442" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px">write.csv2(distinct(meddra[,.(def,soc, hlgt,hlt,pt,llt)]), "External Sources/Dictionaries/MedDRA/meddra.csv")...</text></switch></g><path d="M 89.45 645 Q 89.45 645 90.08 670.76" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 82.24 657.07 L 90.11 671.88 L 97.24 656.7" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"/><rect x="8" y="534" width="160" height="103" rx="15.45" ry="15.45" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 158px; height: 1px; padding-top: 586px; margin-left: 9px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">Read the previously written file "meddra.csv", extract unique lowercase PTs, and store them in "pt_list"</div></div></div></foreignObject><text x="88" y="589" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">Read the previously written...</text></switch></g><rect x="182" y="564" width="680" height="37" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 678px; height: 1px; padding-top: 583px; margin-left: 184px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: left;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><div><font color="#3333ff">pt_list &lt;- unique(tolower(trimws(</font><span style="color: rgb(51, 51, 255); background-color: initial;">setDT(read.csv2("External Sources/Dictionaries/MedDRA/meddra.csv"))$pt)))</span></div></div></div></div></foreignObject><text x="184" y="586" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px">pt_list &lt;- unique(tolower(trimws(setDT(read.csv2("External Sources/Dictionaries/MedDRA/meddra.csv"))$pt)))</text></switch></g><path d="M 90.59 744 Q 90.59 744 90.03 792.78" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 82.69 778.81 L 90.02 793.9 L 97.69 778.98" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"/><rect x="11" y="681" width="160" height="55" rx="8.25" ry="8.25" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 158px; height: 1px; padding-top: 709px; margin-left: 12px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">Import the "pt_fixed.csv" file</div></div></div></foreignObject><text x="91" y="712" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">Import the "pt_fixed.csv" f...</text></switch></g><rect x="182" y="692" width="680" height="37" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 678px; height: 1px; padding-top: 711px; margin-left: 184px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: left;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><font color="#3333ff">manual_fix_file &lt;- "External Sources/Manual_fix/pt_fixed.csv"</font></div></div></div></foreignObject><text x="184" y="714" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px">manual_fix_file &lt;- "External Sources/Manual_fix/pt_fixed.csv"</text></switch></g><path d="M 89 802 L 168 882 L 89 962 L 10 882 Z" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 156px; height: 1px; padding-top: 882px; margin-left: 11px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">Define the function standardize_PT to standardise the pt column in the data file</div></div></div></foreignObject><text x="89" y="886" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">Define the function standa...</text></switch></g><rect x="338" y="846" width="680" height="37" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 678px; height: 1px; padding-top: 865px; margin-left: 340px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: left;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><font color="#3333ff">standardize_PT &lt;- function(data_file, pt_variable) {</font></div></div></div></foreignObject><text x="340" y="868" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px">standardize_PT &lt;- function(data_file, pt_variable) {</text></switch></g><rect x="474" y="883" width="495" height="414" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 493px; height: 1px; padding-top: 1090px; margin-left: 476px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: left;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><div><font color="#3333ff">data &lt;- setDT(readRDS(data_file))</font></div><div><font color="#3333ff"> <span style="background-color: initial;">pt_freq &lt;- data[, .(pt = tolower(trimws(get(pt_variable))))][</span><span style="background-color: initial;">!is.na(pt)][, .N, by = "pt"][order(-N)]</span></font></div><div><font color="#3333ff"><span style="background-color: initial;"><div>pt_freq[, standard_pt := ifelse(pt %in% pt_list, pt, NA)]</div><div>pt_freq[, freq := round(N/sum(N) * 100, 2)]</div><div><div>not_pts &lt;- pt_freq[is.na(standard_pt)][, .(pt, N, freq)]</div><div> print(paste0("The portion of non standardized PTs at the beginning is ", <span style="background-color: initial;">round(sum(not_pts$N)*100/nrow(data[!is.na(get(pt_variable))]),3)))</span></div></div><div><span style="background-color: initial;"><div>llts &lt;- left_join(not_pts, setDT(read.csv2("External Sources/Dictionaries/MedDRA/meddra.csv"))[ <span style="background-color: initial;">, .(standard_pt = pt, pt = llt)])</span></div><div>not_llts &lt;- llts[is.na(standard_pt)] %&gt;% select(-standard_pt)</div><div><div>pt_fixed &lt;- setDT(read.csv2(manual_fix_file))[, .(pt, standard_pt)]</div><div>manual &lt;- left_join(not_llts, pt_fixed)[is.na(standard_pt),][, .(pt, standard_pt)]</div></div><div><div>pt_fixed &lt;- distinct(rbindlist(list(pt_fixed, manual, llts[!is.na(standard_pt), .(pt,standard_pt)])))</div><div>unstandardized_pts &lt;- pt_fixed[is.na(standard_pt)]</div></div><div><div>write.csv2(pt_fixed, manual_fix_file)</div><div>print(paste0(nrow(unstandardized_pts),<span style="background-color: initial;">" pts are not standardized using LLTs or previously proposed manual fix: ", </span><span style="background-color: initial;">paste0(unstandardized_pts$pt,collapse = "; "),</span><span style="background-color: initial;">". Consider updating the pt_fixed.csv file."))</span></div><div>pt_fixed &lt;- setDT(read.csv2(manual_fix_file))[, .(pt_temp=pt, standard_pt)]</div></div><div><div>data &lt;- pt_fixed[data[, pt_temp := tolower(trimws(get(pt_variable)))], on = "pt_temp"][<span style="background-color: initial;">,pt_temp := ifelse(is.na(standard_pt), pt_temp, standard_pt)] %&gt;% select(-standard_pt)</span></div><div>data &lt;- data %&gt;% select(-all_of(pt_variable))</div></div><div><div>standardized_percentage &lt;- round(nrow(data[pt_temp %in% pt_list]) * 100/nrow(data[!is.na(pt_temp)]), 3)</div><div>print(paste0("The portion of standardized PTs at the end is ",<span style="background-color: initial;">standardized_percentage))</span></div><div>setnames(data,old="pt_temp",new=pt_variable)</div></div><div><div>return(data)</div><div>}</div></div></span></div><div><span style="background-color: initial;"><br /></span></div></span></font></div></div></div></div></foreignObject><text x="476" y="1094" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px">data &lt;- setDT(readRDS(data_file))...</text></switch></g><rect x="17" y="1314" width="160" height="55" rx="8.25" ry="8.25" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 158px; height: 1px; padding-top: 1342px; margin-left: 18px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">Standardise PT column in data files and update it</div></div></div></foreignObject><text x="97" y="1345" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">Standardise PT column in da...</text></switch></g><rect x="187" y="1306" width="680" height="91" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 678px; height: 1px; padding-top: 1352px; margin-left: 189px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: left;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><font color="#3333ff">Reac &lt;- standardize_PT("Clean Data/Reac.rds","pt")<br />saveRDS(Reac,"Clean Data/Reac.rds")<br />Reac &lt;- standardize_PT("Clean Data/Reac.rds","drug_rec_act")<br />saveRDS(Reac,"Clean Data/Reac.rds")<br />Indi &lt;- standardize_PT("Clean Data/Indi.rds","indi_pt")<br />saveRDS(Indi,"Clean Data/Indi.rds")<br /><br /></font></div></div></div></foreignObject><text x="189" y="1355" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px">Reac &lt;- standardize_PT("Clean Data/Reac.rds","pt")...</text></switch></g></g><switch><g requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"/><a transform="translate(0,-5)" xlink:href="https://www.drawio.com/doc/faq/svg-export-text-problems" target="_blank"><text text-anchor="middle" font-size="10px" x="50%" y="100%">Text is not SVG - cannot display</text></a></switch></svg>